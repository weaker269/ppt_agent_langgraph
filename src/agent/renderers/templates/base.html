<!DOCTYPE html>
<html lang="zh">
  <head>
    <meta charset="utf-8" />
    <title>{{ title }}</title>
    <style>
      body { background: {{ palette.background }}; color: {{ palette.text }}; font-family: {{ fonts.body }}, sans-serif; margin: 0; }
      header { background: {{ palette.primary }}; color: {{ palette.on_primary }}; padding: 28px 8%; }
      header h1 { margin: 0; font-family: {{ fonts.title }}, sans-serif; }
      header p { margin-top: 8px; opacity: 0.85; }
      section.slide { padding: 32px 10%; border-bottom: 1px solid {{ palette.border }}; }
      section.slide h2 { margin-top: 0; font-family: {{ fonts.title }}, sans-serif; }
      ul { padding-left: 1.4em; }
      .meta { font-size: 0.9rem; color: {{ palette.text_muted }}; }
      .quality { background: {{ palette.accent }}22; border-left: 4px solid {{ palette.accent }}; padding: 12px 16px; margin: 24px 10%; font-size: 0.95rem; }
      footer { padding: 24px 10%; font-size: 0.85rem; color: {{ palette.text_muted }}; }
    </style>
  </head>
  <body>
    <header>
      <h1>{{ title }}</h1>
      <p>{{ subtitle }} · 预计 {{ duration }} 分钟 · 共 {{ slide_count }} 页</p>
    </header>
    {% if quality_summary %}
    <div class="quality">
      <strong>质量评估概览：</strong>
      <p>平均分 {{ quality_summary.average }} 分，低于阈值的幻灯片：{{ quality_summary.below_threshold|join(', ') if quality_summary.below_threshold else '无' }}</p>
    </div>
    {% endif %}
    {% if consistency %}
    <div class="quality">
      <strong>一致性得分：</strong> {{ consistency.score }} 分
      {% if consistency.issues %}
      <p>问题：{{ consistency.issues }}</p>
      {% endif %}
    </div>
    {% endif %}
    {% for slide in slides %}
    <section class="slide">
      <h2>{{ slide.title }}</h2>
      {% if slide.body %}<p>{{ slide.body }}</p>{% endif %}
      {% if slide.bullet_points %}
      <ul>
        {% for item in slide.bullet_points %}<li>{{ item }}</li>{% endfor %}
      </ul>
      {% endif %}
      {% if slide.speaker_notes %}<p class="meta">讲者备注：{{ slide.speaker_notes }}</p>{% endif %}
      {% if slide.quality_score %}<p class="meta">质量得分：{{ '%.1f'|format(slide.quality_score) }}</p>{% endif %}
    </section>
    {% endfor %}
    <footer>由 PPT Agent 自动生成 · 模式：{{ style.reasoning }}</footer>
  </body>
</html>
